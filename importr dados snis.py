import basedosdados as bd

billing_id = <seu_billing_id>

query = """
  SELECT
    dados.ano as ano,
    dados.id_municipio AS id_municipio,
    diretorio_id_municipio.nome AS id_municipio_nome,
    dados.sigla_uf AS sigla_uf,
    diretorio_sigla_uf.nome AS sigla_uf_nome,
    dados.populacao_atendida_agua as populacao_atendida_agua,
    dados.populacao_atentida_esgoto as populacao_atentida_esgoto,
    dados.populacao_urbana as populacao_urbana,
    dados.populacao_urbana_residente_agua as populacao_urbana_residente_agua,
    dados.populacao_urbana_atendida_agua as populacao_urbana_atendida_agua,
    dados.populacao_urbana_atendida_agua_ibge as populacao_urbana_atendida_agua_ibge,
    dados.populacao_urbana_residente_esgoto as populacao_urbana_residente_esgoto,
    dados.populacao_urbana_atendida_esgoto as populacao_urbana_atendida_esgoto,
    dados.populacao_urbana_residente_esgoto_ibge as populacao_urbana_residente_esgoto_ibge,
    dados.extensao_rede_agua as extensao_rede_agua,
    dados.extensao_rede_esgoto as extensao_rede_esgoto,
    dados.quantidade_sede_municipal_agua as quantidade_sede_municipal_agua,
    dados.quantidade_sede_municipal_esgoto as quantidade_sede_municipal_esgoto,
    dados.quantidade_localidade_agua as quantidade_localidade_agua,
    dados.quantidade_localidade_esgoto as quantidade_localidade_esgoto,
    dados.quantidade_ligacao_ativa_agua as quantidade_ligacao_ativa_agua,
    dados.quantidade_ligacao_ativa_esgoto as quantidade_ligacao_ativa_esgoto,
    dados.quantidade_ligacao_total_agua as quantidade_ligacao_total_agua,
    dados.quantidade_ligacao_total_esgoto as quantidade_ligacao_total_esgoto,
    dados.quantidade_economia_ativa_agua as quantidade_economia_ativa_agua,
    dados.quantidade_economia_ativa_esgoto as quantidade_economia_ativa_esgoto,
    dados.quantidade_ligacao_micromedia_ativa_agua as quantidade_ligacao_micromedia_ativa_agua,
    dados.quantidade_economia_residencial_ativa_agua as quantidade_economia_residencial_ativa_agua,
    dados.quantidade_economia_residencial_ativa_esgoto as quantidade_economia_residencial_ativa_esgoto,
    dados.quantidade_economia_micromedida_ativa_agua as quantidade_economia_micromedida_ativa_agua,
    dados.quantidade_economia_residencial_micromedida_ativa_agua as quantidade_economia_residencial_micromedida_ativa_agua,
    dados.volume_agua_produzido as volume_agua_produzido,
    dados.volume_agua_tratada_eta as volume_agua_tratada_eta,
    dados.volume_agua_micromedido as volume_agua_micromedido,
    dados.volume_agua_consumido as volume_agua_consumido,
    dados.volume_agua_faturado as volume_agua_faturado,
    dados.volume_agua_macromedido as volume_agua_macromedido,
    dados.volume_agua_tratada_desinfeccao as volume_agua_tratada_desinfeccao,
    dados.volume_agua_bruta_exportado as volume_agua_bruta_exportado,
    dados.volume_agua_tratada_importado as volume_agua_tratada_importado,
    dados.volume_agua_tratada_exportado as volume_agua_tratada_exportado,
    dados.volume_agua_micromedido_economia_ativa as volume_agua_micromedido_economia_ativa,
    dados.volume_servico_agua as volume_servico_agua,
    dados.volume_agua_fluoretada as volume_agua_fluoretada,
    dados.consumo_eletrico_sistemas_agua as consumo_eletrico_sistemas_agua,
    dados.volume_esgoto_coletado as volume_esgoto_coletado,
    dados.volume_esgoto_tratado as volume_esgoto_tratado,
    dados.volume_esgoto_faturado as volume_esgoto_faturado,
    dados.volume_esgoto_bruto_exportado as volume_esgoto_bruto_exportado,
    dados.volume_esgoto_bruto_importado as volume_esgoto_bruto_importado,
    dados.volume_esgoto_importado as volume_esgoto_importado,
    dados.volume_esgoto_bruto_exportado_tratamento_importador as volume_esgoto_bruto_exportado_tratamento_importador,
    dados.consumo_eletrico_sistemas_esgoto as consumo_eletrico_sistemas_esgoto,
    dados.indice_agua_ligacao as indice_agua_ligacao,
    dados.indice_hidrometracao as indice_hidrometracao,
    dados.indice_macromedicao_volume_disponibilizado as indice_macromedicao_volume_disponibilizado,
    dados.indice_macromedicao as indice_macromedicao,
    dados.indice_perda_faturamento as indice_perda_faturamento,
    dados.indice_micromedido_economia as indice_micromedido_economia,
    dados.indice_coleta_esgoto as indice_coleta_esgoto,
    dados.indice_tratamento_esgoto as indice_tratamento_esgoto,
    dados.indice_consumo_agua_faturado as indice_consumo_agua_faturado,
    dados.indice_extensao_agua_ligacao as indice_extensao_agua_ligacao,
    dados.indice_extensao_esgoto_ligacao as indice_extensao_esgoto_ligacao,
    dados.indice_consumo_agua_per_capita as indice_consumo_agua_per_capita,
    dados.indice_atendimento_urbano_agua as indice_atendimento_urbano_agua,
    dados.indice_atendimento_agua_esgoto as indice_atendimento_agua_esgoto,
    dados.indice_volume_agua_economia as indice_volume_agua_economia,
    dados.indice_faturamento_agua as indice_faturamento_agua,
    dados.indice_participacao_economia_agua as indice_participacao_economia_agua,
    dados.indice_micromedicao_relativo_agua as indice_micromedicao_relativo_agua,
    dados.indice_esgotamento_agua_consumida as indice_esgotamento_agua_consumida,
    dados.indice_atendimento_esgoto_esgoto as indice_atendimento_esgoto_esgoto,
    dados.indice_perda_distribuicao_agua as indice_perda_distribuicao_agua,
    dados.indice_perda_linear_agua as indice_perda_linear_agua,
    dados.indice_perda_ligacao_agua as indice_perda_ligacao_agua,
    dados.indice_consumo_agua as indice_consumo_agua,
    dados.indice_consumo_medio_agua as indice_consumo_medio_agua,
    dados.indice_atendimento_total_agua as indice_atendimento_total_agua,
    dados.indice_atendimento_esgoto_agua as indice_atendimento_esgoto_agua,
    dados.indice_fluoretacao_agua as indice_fluoretacao_agua,
    dados.indice_consumo_energia_agua as indice_consumo_energia_agua,
    dados.indice_consumo_energia_esgoto as indice_consumo_energia_esgoto,
    dados.receita_operacional_direta as receita_operacional_direta,
    dados.receita_operacional_direta_agua as receita_operacional_direta_agua,
    dados.receita_operacional_direta_esgoto as receita_operacional_direta_esgoto,
    dados.receita_operacional_indireta as receita_operacional_indireta,
    dados.receita_operacional_direta_agua_exportada as receita_operacional_direta_agua_exportada,
    dados.receita_operacional as receita_operacional,
    dados.receita_operacional_direta_esgoto_importado as receita_operacional_direta_esgoto_importado,
    dados.arrecadacao_total as arrecadacao_total,
    dados.credito_areceber as credito_areceber,
    dados.despesa_pessoal as despesa_pessoal,
    dados.quantidade_empregado as quantidade_empregado,
    dados.despesa_produto_quimico as despesa_produto_quimico,
    dados.despesa_energia as despesa_energia,
    dados.despesa_servico_terceiro as despesa_servico_terceiro,
    dados.despesa_exploracao as despesa_exploracao,
    dados.despesas_juros_divida as despesas_juros_divida,
    dados.despesa_total_servico as despesa_total_servico,
    dados.despesa_ativo as despesa_ativo,
    dados.despesa_agua_importada as despesa_agua_importada,
    dados.despesa_fiscal as despesa_fiscal,
    dados.despesa_fiscal_nao_computada as despesa_fiscal_nao_computada,
    dados.despesa_exploracao_outro as despesa_exploracao_outro,
    dados.despesa_servico_outro as despesa_servico_outro,
    dados.despesa_amortizacao_divida as despesa_amortizacao_divida,
    dados.despesas_juros_divida_excecao as despesas_juros_divida_excecao,
    dados.despesa_divida_variacao as despesa_divida_variacao,
    dados.despesa_divida_total as despesa_divida_total,
    dados.despesa_esgoto_exportado as despesa_esgoto_exportado,
    dados.despesa_capitalizavel_municipio as despesa_capitalizavel_municipio,
    dados.despesa_capitalizavel_estado as despesa_capitalizavel_estado,
    dados.despesa_capitalizavel_prestador as despesa_capitalizavel_prestador,
    dados.investimento_agua_prestador as investimento_agua_prestador,
    dados.investimento_esgoto_prestador as investimento_esgoto_prestador,
    dados.investimento_outro_prestador as investimento_outro_prestador,
    dados.investimento_recurso_proprio_prestador as investimento_recurso_proprio_prestador,
    dados.investimento_recurso_oneroso_prestador as investimento_recurso_oneroso_prestador,
    dados.investimento_recurso_nao_oneroso_prestador as investimento_recurso_nao_oneroso_prestador,
    dados.investimento_total_prestador as investimento_total_prestador,
    dados.investimento_agua_municipio as investimento_agua_municipio,
    dados.investimento_esgoto_municipio as investimento_esgoto_municipio,
    dados.investimento_outro_municipio as investimento_outro_municipio,
    dados.investimento_recurso_proprio_municipio as investimento_recurso_proprio_municipio,
    dados.investimento_recurso_oneroso_municipio as investimento_recurso_oneroso_municipio,
    dados.investimento_recurso_nao_oneroso_municipio as investimento_recurso_nao_oneroso_municipio,
    dados.investimento_total_municipio as investimento_total_municipio,
    dados.investimento_agua_estado as investimento_agua_estado,
    dados.investimento_esgoto_estado as investimento_esgoto_estado,
    dados.investimento_outro_estado as investimento_outro_estado,
    dados.investimento_recurso_proprio_estado as investimento_recurso_proprio_estado,
    dados.investimento_recurso_oneroso_estado as investimento_recurso_oneroso_estado,
    dados.investimento_recurso_nao_oneroso_estado as investimento_recurso_nao_oneroso_estado,
    dados.investimento_total_estado as investimento_total_estado
FROM `basedosdados.br_mdr_snis.municipio_agua_esgoto` AS dados
LEFT JOIN (SELECT DISTINCT id_municipio,nome  FROM `basedosdados.br_bd_diretorios_brasil.municipio`) AS diretorio_id_municipio
    ON dados.id_municipio = diretorio_id_municipio.id_municipio
LEFT JOIN (SELECT DISTINCT sigla,nome  FROM `basedosdados.br_bd_diretorios_brasil.uf`) AS diretorio_sigla_uf
    ON dados.sigla_uf = diretorio_sigla_uf.sigla
"""

bd.read_sql(query = query, billing_project_id = billing_id)